## Описание проекта

Данный проект реализует микрофронтенд-архитектуру с использованием `single-spa`. Каждый микрофронтенд отвечает за определенные функции приложения и может быть независимо развернут и обновлен.

### Основные принципы разделения

- **Изоляция ответственности**: Каждый микрофронтенд отвечает за отдельный участок функциональности, что упрощает поддержку и развитие кода.
- **Масштабируемость**: Микрофронтенды могут быть развернуты и обновлены независимо, что позволяет быстро выпускать обновления.
- **Гибкость**: Использование `single-spa` позволяет смешивать разные технологии (если потребуется) и создавать независимые приложения.

### Использование

Чтобы начать, установите зависимости и настройте окружение для каждого микрофронтенда. Root-config является основным проектом, запускающим и связывающим остальные микрофронтенды.

1. **Установка**:
   - Перейдите в директорию нужного микрофронтенда.
   - Установите зависимости: `yarn install`

2. **Запуск локально**:
   - Для запуска всех микрофронтендов используйте команду `yarn start` в каждом из них. Root-config будет подключать их через `single-spa`.

3. **Разработка и деплой**:
   - Каждый микрофронтенд разворачивается независимо и может быть подключен к корневому приложению при помощи конфигурации URL.


### Уровень 1. Проектирование
Для создания микрофронтендов выберем `single-spa` как фреймворк для микрофронтенд-архитектуры. `Single-spa` предоставляет гибкий подход к интеграции различных микрофронтендов, написанных на разных фреймворках (например, React, Vue и других), и обеспечивает управление их рендерингом в зависимости от текущего URL.

#### Почему single-spa?
- **Легкость интеграции**: 
single-spa позволяет создать корневое приложение (root-config) и микрофронтенды, которые можно регистрировать и подгружать по мере необходимости.
- **Поддержка независимых микрофронтендов**: 
Каждый микрофронтенд может быть развернут и обновлен независимо, что облегчает управление и ускоряет разработку.
- **Масштабируемость и модульность**:
Позволяет изолировать различные части приложения, сохраняя их независимость, что упрощает тестирование и управление зависимостями.

Кроме того, следует отметить, что сама область frontend-разработки является очень динамичной, и появляется большое количество различных технологий, что накладывает определеные требования к гибкости, и  `single-spa` вполне удовлетворяет этому требование.

#### Описание решения
1. _Общая архитектура приложения_:

Приложение будет состоять из нескольких основных микрофронтендов:

- **Корневое приложение (Root Config)**: контролирует навигацию, связывает микрофронтенды, отвечает за рендеринг общего интерфейса, а также содержит общие элементы интерфейса, такие как Header и Footer, а также рендерит компоненты навигации.
- **Auth Модуль**: отвечает за аутентификацию и регистрацию пользователей.
- **Profile Модуль**: реализует функциональность профиля пользователя и интерфейсы для редактирования аватара и данных профиля.
- **Feed Модуль**: отображает ленту фотографий и предоставляет возможность их загрузки, удаления и проставления лайков.

2. _Роутинг и загрузка микрофронтендов_:

Каждый микрофронтенд будет подгружаться через корневое приложение с использованием `single-spa`. В зависимости от URL, `single-spa` будет подгружать необходимый микрофронтенд, обеспечивая seamless-переход между ними.

3. _Организация модулей_:

**Корневое приложение (root-config)**: Подгружает каждый микрофронтенд по URL с использованием registerApplication от single-spa, а также определяет навигацию по основным страницам и подгружает Header и Footer, видимые на всех страницах.

**Auth**: Включает страницы /login и /register, которые будут доступны неавторизованным пользователям.

**Profile**: Включает компоненты для управления профилем, такие как редактирование данных и аватара. Рендерится при переходе на /.

**Feed**: Включает ленту фотографий и необходимые попапы для загрузки и просмотра изображений, доступна по пути /.

4. _Стратегия развертывания_:

Каждый микрофронтенд будет собираться отдельно и развертываться на CDN или сервере.
root-config будет включать ссылки на микрофронтенды, что позволит динамически обновлять каждый модуль без необходимости разворачивать всё приложение целиком.

5. _Архитектурная схема (описание)_:

Корневое приложение управляет роутингом и состоянием аутентификации.
Микрофронтенды (Auth, Profile, Feed) работают независимо и подгружаются только по мере необходимости.
Коммуникация между модулями происходит через общий глобальный объект или с использованием событий, чтобы избежать жестких зависимостей.

### Уровень 2. Планирование изменений
Для реализации микрофронтенд-архитектуры с использованием `single-spa`, структуру кода можно организовать следующим образом. Она будет включать несколько отдельных проектов, каждый из которых будет соответствовать отдельному микрофронтенду, и один проект для корневого приложения, которое связывает все микрофронтенды вместе.

Кэширование и lazy-loading: Чтобы повысить производительность, можно использовать lazy-loading для подгрузки модулей только при необходимости.

Эта структура позволяет изолировать ключевые страницы и компоненты приложения и упростит поддержку и расширение микрофронтендов, а также обеспечит защиту приватных данных через ProtectedRoute и гибкость в разработке.

Упрощенная структура проекта
```plaintext
mesto/
├── root-config/              # Корневое приложение для управления микрофронтендами, роутинга, и для оболочки приложения
│   ├── src/
│   │   ├── components/
│   │   │   ├── Header.js     # Шапка сайта
│   │   │   ├── Footer.js     # Подвал сайта
│   │   │   └── ProtectedRoute.js # Компонент защищенного маршрута
│   │   ├── MainShellApp.js   # Главный компонент микрофронтенда MainShell
│   │   ├── index.js          # Точка входа и регистрация микрофронтендов через single-spa
│   │   └── single-spa-config.js  # Конфигурация роутинга и загрузки микрофронтендов
│   └── README.md             # Описание корневого приложения
├── auth/                     # Микрофронтенд для аутентификации (login, register)
│   ├── src/
│   │   ├── components/
│   │   │   ├── Login.js      # Страница входа
│   │   │   └── Register.js   # Страница регистрации
│   │   ├── AuthApp.js        # Главный компонент микрофронтенда Auth
│   │   └── index.js          # Точка входа для регистрации как микрофронтенда
│   └── README.md             # Описание микрофронтенда Auth
├── profile/                  # Микрофронтенд для профиля пользователя
│   ├── src/
│   │   ├── components/
│   │   │   ├── Profile.js            # Главная страница профиля
│   │   │   ├── EditProfilePopup.js   # Компонент редактирования профиля
│   │   │   └── EditAvatarPopup.js    # Компонент редактирования аватара
│   │   ├── ProfileApp.js     # Главный компонент микрофронтенда Profile
│   │   └── index.js          # Точка входа для регистрации как микрофронтенда
│   └── README.md             # Описание микрофронтенда Profile
├── feed/                     # Микрофронтенд для ленты фотографий
│   ├── src/
│   │   ├── components/
│   │   │   ├── Feed.js       # Главный компонент ленты
│   │   │   ├── Card.js       # Компонент карточки фотографии
│   │   │   ├── AddPlacePopup.js   # Компонент добавления места (фотографии)
│   │   │   └── ImagePopup.js      # Компонент для показа изображения в попапе
│   │   ├── FeedApp.js        # Главный компонент микрофронтенда Feed
│   │   └── index.js          # Точка входа для регистрации как микрофронтенда
│   └── README.md             # Описание микрофронтенда Feed
└── README.md                 # Общий README для всего проекта
```

#### Разделение компонентов

Для разбиения фронтенда на микрофронтенды с использованием `single-spa` можно начать с логического разделения приложения на отдельные модули, каждый из которых будет решать свою часть задач. Основные страницы, компоненты и функциональность лучше организовать в отдельных микрофронтендах. Вот план:

1. Auth-модуль

**Описание:** Отвечает за аутентификацию и регистрацию пользователей.

**Роли:** Обеспечивает регистрацию и вход в приложение, а также обработку 
пользовательских данных при логине.

**Основные компоненты:**
Login.js
Register.js
InfoTooltip.js (может использоваться для уведомлений при логине/регистрации)

**Расположение в single-spa:** Зарегистрировать как отдельное приложение, которое будет загружаться, только если пользователь не авторизован (например, по URL-пути /login или /register).

2. Root-config \ Host (корневое приложение)

**Описание:** Корневое приложение, которое объединяет все остальные микрофронтенды, обрабатывает роутинг и общие компоненты интерфейса.

**Роли:** Отвечает за рендеринг общих компонентов, таких как Header.js, Footer.js, и навигацию.

**Основные компоненты:**
App.js
Header.js
Footer.js

**Расположение в single-spa:** Это центральное приложение, которое отвечает за роутинг и связывание других микрофронтендов.

3. Профиль пользователя

**Описание:** Управление профилем пользователя, редактирование аватара и информации о профиле.

**Роли:** Предоставляет пользователю возможность редактировать свои данные и аватар.

**Основные компоненты:**
EditProfilePopup.js
EditAvatarPopup.js
ProtectedRoute.js (для защиты доступа к этому модулю)
Profile.js (создать для управления профилем)

**Расположение в single-spa:** Зарегистрировать как отдельное приложение и отображать, когда пользователь переходит на страницу профиля или открывает попап для редактирования.

4. Фото Feed

**Описание:** Лента с фотографиями, где пользователи могут загружать, удалять и лайкать изображения.

**Роли:** Реализует отображение ленты фотографий, интерактивные функции (лайки, удаление, загрузка).

**Основные компоненты:**
Card.js (компонент для отображения фотографий)
AddPlacePopup.js (попап для добавления нового фото)
ImagePopup.js (попап для просмотра фото в увеличенном виде)
Main.js (основной компонент страницы с лентой)

Расположение в single-spa: Зарегистрировать как отдельное приложение, загружающееся по роуту основной страницы /feed или /main.

5. Общие попапы и формы

**Описание:** Модуль, содержащий общие компоненты для попапов и форм, которые могут использоваться в нескольких местах приложения.

**Роли:** Вспомогательные компоненты, которые используются для отображения всплывающих окон и работы с формами.

**Основные компоненты:**
PopupWithForm.js (универсальный попап с формой)
InfoTooltip.js (если также используется в профиле или ленте)

**Расположение в single-spa:** Зарегистрировать как библиотечный модуль или микрофронтенд, доступный другим модулям для интеграции.

Кроме этого, также планируется использовать общие проекты, которые бы содержали как shared dependencies, стили, util-функции и функциональность, и возможно более укрупненные сущности - компоненты.

Также планируется иметь makefile для удобства разворачивания всего приложения локально.